(this.webpackJsonpdiyhue=this.webpackJsonpdiyhue||[]).push([[16],{198:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return P}));var a=c(36),n=c(2),i=c(60),s=c.n(i),o=c(188),l=c(169),r=c(31),d=c(186),u=c(88),j=c(174),h=c.n(j);function p(e,t,c){void 0===c&&(c=254);var a=1-e-t,n=(c/254).toFixed(2),i=n/t*e,s=n/t*a,o=1.656492*i-.354851*n-.255038*s,l=.707196*-i+1.655397*n+.036152*s,r=.051713*i-.121364*n+1.01153*s;return o>r&&o>l&&o>1?(l/=o,r/=o,o=1):l>r&&l>o&&l>1?(o/=l,r/=l,l=1):r>o&&r>l&&r>1&&(o/=r,l/=r,r=1),o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,l=l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055,r=r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055,o=Math.round(255*o),l=Math.round(255*l),r=Math.round(255*r),isNaN(o)&&(o=0),isNaN(l)&&(l=0),isNaN(r)&&(r=0),"rgba("+Math.floor(o)+","+Math.floor(l)+","+Math.floor(r)+",1)"}function b(e){var t,c,a,n=2e4/e;return n<=66?(t=255,c=99.4708025861*Math.log(n)-161.1195681661,a=n<=19?0:138.5177312231*Math.log(n-10)-305.0447927307):(t=329.698727446*Math.pow(n-60,-.1332047592),c=288.1221695283*Math.pow(n-60,-.0755148492),a=255),t=t>255?255:t,c=c>255?255:c,a=a>255?255:a,"rgba("+Math.floor(t)+","+Math.floor(c)+","+Math.floor(a)+",1)"}function O(e,t,c){var a=.664511*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.154324*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.162028*(c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92),n=.283881*e+.668433*t+.047685*c,i=88e-6*e+.07231*t+.986039*c,s=(a/(a+n+i)).toFixed(4),o=(n/(a+n+i)).toFixed(4);return isNaN(s)&&(s=0),isNaN(o)&&(o=0),[parseFloat(s),parseFloat(o)]}var g=c.p+"static/media/nightsky.a7e58287.jpg",f=(c.p,c.p,c(7)),x=function(e){var t=e.HOST_IP,c=e.api_key,n=e.groupId,i=e.scenes,o=e.sceneModal,l=e.setSceneModal;function d(){l(!1)}return Object(f.jsxs)(h.a,{isOpen:o,onAfterOpen:function(){},onRequestClose:d,contentLabel:"Example Modal",children:[Object(f.jsxs)("div",{className:"header",children:[Object(f.jsx)("div",{className:"headline",children:"Scene Picker"}),Object(f.jsx)("div",{className:"iconbox",children:Object(f.jsx)("button",{onClick:d,children:Object(f.jsx)(r.q,{})})})]}),Object(f.jsx)("div",{className:"scenecontainer",children:Object.entries(i).filter((function(e){return e[1].group===n})).map((function(e){var n=Object(a.a)(e,2),i=n[0],o=n[1];return Object(f.jsxs)("div",{className:"scene",style:{background:"url(".concat(g,")"),backgroundSize:"cover"},onClick:function(){return function(e){s.a.put("".concat(t,"/api/").concat(c,"/groups/0/action"),{scene:e})}(i)},children:[Object(f.jsxs)("div",{className:"dimmer",children:[Object.entries(o.lightstates).filter((function(e,t){return t<5})).map((function(e){var n,i=Object(a.a)(e,2),o=i[0],l=i[1];return Object(f.jsx)("div",{className:"color",style:{background:"".concat((n=l,"xy"in n?p(n.xy[0],n.xy[1],254):"ct"in n?b(n.ct):"rgba(200,200,200,1)"))},onClick:function(){return function(e,a){s.a.put("".concat(t,"/api/").concat(c,"/lights/").concat(e,"/state"),a)}(o,l)}})})),Object(f.jsx)("div",{className:"name",children:o.name})]}),Object(f.jsx)("div",{className:"dynamiccontrol",children:Object(f.jsx)("i",{className:"far fa-play-circle"})})]})}))})]})},v=c(184),y=function(e){var t=e.HOST_IP,c=e.api_key,a=e.id,n=e.light,i=function(e){console.log("Apply state "+JSON.stringify(e)),s.a.put("".concat(t,"/api/").concat(c,"/lights/").concat(a,"/state"),e)};return Object(f.jsxs)("div",{className:"groupCard light",children:[Object(f.jsxs)("div",{className:"row top",children:[Object(f.jsx)("div",{className:"gradient",style:function(){if(n.state.on)return{background:"xy"===n.state.colormode?p(n.state.xy[0],n.state.xy[1],254):"ct"===n.state.colormode?b(n.state.ct):"linear-gradient(90deg, rgba(255,212,93,1))"}}(),children:Object(f.jsx)(r.k,{})}),Object(f.jsx)("div",{className:"text",children:Object(f.jsxs)("p",{className:"name",children:[n.name," ",n.state.reachable||Object(f.jsx)(v.a,{title:"Unrechable"})]})}),Object(f.jsx)("div",{className:"switchContainer",children:Object(f.jsxs)("label",{className:"switch",children:[Object(f.jsx)("input",{type:"checkbox",defaultChecked:n.state.on,onChange:function(e){return i({on:e.currentTarget.checked})}}),Object(f.jsx)("span",{className:"slider"})]})})]}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"sliderContainer",children:Object(f.jsx)("input",{type:"range",min:"1",max:"254",defaultValue:n.state.bri,className:"slider",onChange:function(e){return i({bri:parseInt(e.currentTarget.value)})}})})})]})},m=c(173);function N(e){var t=e.HOST_IP,c=e.api_key,i=e.lights,o=e.groupLights,r=Object(n.useRef)(null),d=Object(n.useRef)(null),u=Object(n.useState)(!0),j=Object(a.a)(u,2),h=(j[0],j[1]);Object(n.useEffect)((function(){return h(!1),function(){h(!1)}}),[]);var b,g=[],x=Object(l.a)(o.entries());try{for(x.s();!(b=x.n()).done;){var v=Object(a.a)(b.value,2),y=(v[0],v[1]);console.log(y),"xy"in i[y].state&&g.push(p(i[y].state.xy[0],i[y].state.xy[1],254))}}catch(k){x.e(k)}finally{x.f()}var N=function(e){var a=e.rgb;console.log(e.rgb),console.log("Apply state "+JSON.stringify(e)),s.a.put("".concat(t,"/api/").concat(c,"/lights/").concat(o[e.index],"/state"),{xy:O(a.r,a.g,a.b)})};return Object(n.useEffect)((function(){r.current&&!d.current&&(d.current=new m.a.ColorPicker(r.current,{layout:[{component:m.a.ui.Wheel,options:{}}],colors:g}),d.current.on("input:end",N))}),[N]),Object(f.jsx)("div",{ref:r})}function k(e){var t=e.HOST_IP,c=e.api_key,i=e.group,o=e.groupId,l=Object(n.useRef)(null),r=Object(n.useRef)(null),d=Object(n.useState)(!0),u=Object(a.a)(d,2),j=(u[0],u[1]);Object(n.useEffect)((function(){return j(!1),function(){j(!1)}}),[]);var h=function(e){var a=e.kelvin,n=Math.floor((11e3-a)/25.5+153);console.log("#########"),console.log(n),console.log(b(i.action.ct)),console.log("Apply state "+JSON.stringify(e)),s.a.put("".concat(t,"/api/").concat(c,"/groups/").concat(o,"/action"),{ct:n})};return Object(n.useEffect)((function(){l.current&&!r.current&&(r.current=new m.a.ColorPicker(l.current,{layoutDirection:"horizontal",layout:[{component:m.a.ui.Slider,options:{sliderType:"kelvin",sliderShape:"circle"}}],color:b(i.action.ct)}),r.current.on("input:end",h))}),[h]),Object(f.jsx)("div",{ref:l})}var w=c(185),_=c.n(w),M=c(161),S=c(160),C=c(199),T=function(e){var t=e.HOST_IP,c=e.api_key,i=e.id,j=e.group,h=e.lights,O=e.scenes,g=Object(n.useState)("closed"),v=Object(a.a)(g,2),m=v[0],w=v[1],T=Object(n.useState)(!1),P=Object(a.a)(T,2),I=P[0],H=P[1],A=Object(n.useState)([]),E=Object(a.a)(A,2),J=E[0],F=E[1],R={opened:{opacity:1},closed:{opacity:0}};!function(){var e,t=Object(l.a)(j.lights.entries());try{for(t.s();!(e=t.n()).done;){var c=Object(a.a)(e.value,2),n=(c[0],c[1]);"xy"in h[n].state&&!J.includes("xy")&&F([].concat(Object(o.a)(J),["xy"])),"ct"in h[n].state&&!J.includes("ct")&&F([].concat(Object(o.a)(J),["ct"]))}}catch(i){t.e(i)}finally{t.f()}}(),console.log(J);var L=Object(n.useCallback)(_()((function(e){j.action.bri=e;var a={bri:e};console.log("Apply state "+JSON.stringify(a)),s.a.put("".concat(t,"/api/").concat(c,"/groups/").concat(i,"/action"),a)}),300),[]);return Object(f.jsxs)("div",{className:"groupCard",children:[Object(f.jsx)(x,{HOST_IP:t,api_key:c,groupId:i,scenes:O,sceneModal:I,setSceneModal:H}),Object(f.jsxs)("div",{className:"row top",children:[Object(f.jsx)("div",{className:"gradient",style:function(){if(j.state.any_on){var e,t="linear-gradient(45deg, ",c=100/j.lights.length,n=Object(l.a)(j.lights.entries());try{for(n.s();!(e=n.n()).done;){var i=Object(a.a)(e.value,2),s=i[0],o=i[1];"xy"===h[o].state.colormode?(1===j.lights.length&&(t+="rgba(200,200,200,1) 0%,"),t=t+p(h[o].state.xy[0],h[o].state.xy[1],254)+" "+Math.floor(c*(s+1))+"%,"):"ct"===h[o].state.colormode?(1===j.lights.length&&(t+="rgba(200,200,200,1) 0%,"),t=t+b(h[o].state.ct)+" "+Math.floor(c*(s+1))+"%,"):(1===j.lights.length&&(t+="rgba(200,200,200,1) 0%,"),t=t+"rgba(255,212,93,1) "+Math.floor(c*(s+1))+"%,")}}catch(r){n.e(r)}finally{n.f()}return{background:t.slice(0,-1)+")"}}}(),children:"Zone"===j.type?Object(f.jsx)(d.a,{style:{fill:j.state.any_on?"#3a3a3a":"#ddd"}}):Object(f.jsx)(r.d,{style:{fill:j.state.any_on?"#3a3a3a":"#ddd"}})}),Object(f.jsxs)("div",{className:"text",children:[Object(f.jsxs)("p",{className:"name",children:[" ",j.name," "]}),Object(f.jsx)("p",{className:"subtext",children:function(){var e,t=0,c=0,n=Object(l.a)(j.lights.entries());try{for(n.s();!(e=n.n()).done;){var i=Object(a.a)(e.value,2),s=(i[0],i[1]);!0===h[s].state.on?t+=1:c+=1}}catch(o){n.e(o)}finally{n.f()}return 0===t?"All lights off":0===c?"All lights on":t+" lights on"}()})]}),Object(f.jsx)("div",{className:"switchContainer",children:Object(f.jsxs)("label",{className:"switch",children:[Object(f.jsx)("input",{type:"checkbox",defaultValue:j.state.any_on,defaultChecked:j.state.any_on,onChange:function(e){return function(e){var a={on:e};j.state.any_on=e,e||w("closed"),console.log("Apply state "+JSON.stringify(a)),s.a.put("".concat(t,"/api/").concat(c,"/groups/").concat(i,"/action"),a)}(e.target.checked)}}),Object(f.jsx)("span",{className:"slider",children:" "})]})})]}),Object(f.jsx)("div",{className:"row background",children:Object(f.jsx)(M.a,{initial:!1,children:j.state.any_on&&Object(f.jsx)(S.a.div,{className:"sliderContainer",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.3},children:Object(f.jsx)("input",{type:"range",min:"1",max:"254",defaultValue:j.action.bri,step:"1",className:"slider",onChange:function(e){return L(parseInt(e.target.value))}})})})}),Object(f.jsxs)(C.a,{children:["closed"!==m&&Object(f.jsxs)(S.a.div,{className:"row buttons",initial:"closed",animate:"closed"===m?"closed":"opened",variants:R,children:[Object(f.jsx)(S.a.div,{className:"btn ".concat(J.includes("xy")?"":"disabled"),whileHover:{scale:1.2},whileTap:{scale:.9},variants:R,children:Object(f.jsx)(r.n,{onClick:!!J.includes("xy")&&function(){return w("colorPicker")}})}),Object(f.jsx)(S.a.div,{className:"btn ".concat(J.includes("ct")?"":"disabled"),whileHover:{scale:1.2},whileTap:{scale:.9},children:Object(f.jsx)(u.b,{onClick:!!J.includes("ct")&&function(){return w("colorTempPicker")}})}),Object(f.jsx)(S.a.div,{className:"btn",whileHover:{scale:1.2},whileTap:{scale:.9},children:Object(f.jsx)(r.i,{onClick:function(){return H(!0)}})}),Object(f.jsx)(S.a.div,{className:"btn",whileHover:{scale:1.2},whileTap:{scale:.9},children:Object(f.jsx)(r.k,{onClick:function(){return w("lights")}})})]}),Object(f.jsx)(S.a.div,{className:"row colorpicker",children:Object(f.jsxs)(M.a,{initial:!1,exitBeforeEnter:!0,children:["colorPicker"===m&&Object(f.jsx)(S.a.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,scale:1,height:"auto"},collapsed:{opacity:0,scale:.5,height:0}},transition:{duration:.3},children:Object(f.jsx)(N,{HOST_IP:t,api_key:c,lights:h,groupLights:j.lights})},"content"),"colorTempPicker"===m&&Object(f.jsx)(S.a.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto",scale:1},collapsed:{opacity:0,height:0}},transition:{duration:.3},children:Object(f.jsx)(k,{HOST_IP:t,api_key:c,groupId:i,group:j})},"content"),"lights"===m&&Object(f.jsx)(S.a.div,{className:"lights",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.3},children:j.lights.map((function(e){return Object(f.jsx)(y,{HOST_IP:t,api_key:c,id:e,light:h[e]},e)}))})]})})]}),Object(f.jsx)(M.a,{children:Object(f.jsx)("div",{className:"row bottom",children:Object(f.jsx)(S.a.div,{className:"expandbtn",initial:"collapsed",animate:"closed"===m?"collapsed":"open",whileHover:{scale:1.2},whileTap:{scale:.9},variants:{open:{rotate:180},collapsed:{rotate:0}},transition:{duration:.3},children:Object(f.jsx)(r.b,{onClick:function(){"closed"===m?J.includes("xy")?w("colorPicker"):J.includes("ct")?w("colorTempPicker"):w("lights"):w("closed")}})})})})]})};function P(e){var t=e.HOST_IP,c=e.API_KEY,i=Object(n.useState)({config:{},lights:{},groups:{},scenes:{}}),o=Object(a.a)(i,2),l=o[0],r=o[1];return Object(n.useEffect)((function(){var e=function(){void 0!==c&&s.a.get("".concat(t,"/api/").concat(c)).then((function(e){console.log(e.data),r(e.data)})).catch((function(e){console.error(e)}))};e();var a=setInterval((function(){e()}),2e3);return function(){return clearInterval(a)}}),[t,c]),Object(f.jsx)("div",{className:"inner",children:Object(f.jsx)("div",{className:"cardGrid",children:Object.entries(l.groups).filter((function(e){return"Entertainment"!==e[1].type})).map((function(e){var n=Object(a.a)(e,2),i=n[0],s=n[1];return Object(f.jsx)(T,{api_key:c,HOST_IP:t,id:i,group:s,lights:l.lights,scenes:l.scenes},i)}))})})}}}]);
//# sourceMappingURL=16.8678a224.chunk.js.map
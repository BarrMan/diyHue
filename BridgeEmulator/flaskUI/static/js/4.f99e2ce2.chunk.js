(this.webpackJsonpDiyHue=this.webpackJsonpDiyHue||[]).push([[4],{85:function(t,e,c){"use strict";c.r(e),c.d(e,"default",(function(){return O}));var n=c(22),a=c(1),s=c(56),r=c.n(s),o=c(65),i=c(9);function l(t,e,c){void 0===c&&(c=254);var n=1-t-e,a=(c/254).toFixed(2),s=a/e*t,r=a/e*n,o=1.656492*s-.354851*a-.255038*r,i=.707196*-s+1.655397*a+.036152*r,l=.051713*s-.121364*a+1.01153*r;return o>l&&o>i&&o>1?(i/=o,l/=o,o=1):i>l&&i>o&&i>1?(o/=i,l/=i,i=1):l>o&&l>i&&l>1&&(o/=l,i/=l,l=1),o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,i=i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055,l=l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055,o=Math.round(255*o),i=Math.round(255*i),l=Math.round(255*l),isNaN(o)&&(o=0),isNaN(i)&&(i=0),isNaN(l)&&(l=0),"rgba("+Math.floor(o)+","+Math.floor(i)+","+Math.floor(l)+",1)"}function u(t){var e,c,n,a=2e4/t;return a<=66?(e=255,c=99.4708025861*Math.log(a)-161.1195681661,n=a<=19?0:138.5177312231*Math.log(a-10)-305.0447927307):(e=329.698727446*Math.pow(a-60,-.1332047592),c=288.1221695283*Math.pow(a-60,-.0755148492),n=255),e=e>255?255:e,c=c>255?255:c,n=n>255?255:n,"rgba("+Math.floor(e)+","+Math.floor(c)+","+Math.floor(n)+",1)"}function j(t,e,c){var n=.664511*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.154324*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.162028*(c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92),a=.283881*t+.668433*e+.047685*c,s=88e-6*t+.07231*e+.986039*c,r=(n/(n+a+s)).toFixed(4),o=(a/(n+a+s)).toFixed(4);return isNaN(r)&&(r=0),isNaN(o)&&(o=0),[parseFloat(r),parseFloat(o)]}var d=c(5),h=function(t){t.user;var e=t.groupId,c=t.scenes;return console.log("group is "+e),Object(d.jsxs)(d.Fragment,{children:[Object.entries(c).filter((function(t){return t[1].group===e})).map((function(t){var e=Object(n.a)(t,2),c=e[0],a=e[1];return Object(d.jsx)("div",{className:"sceneContainer",onClick:function(){return function(t,e){r.a.put("/api/".concat(t,"/groups/0/action"),{scene:e})}(c)},children:Object(d.jsx)("p",{style:{color:"#ccc"},children:a.name})},c)})),Object(d.jsx)("div",{className:"clear"})]})},b=function(t){var e=t.user,c=t.id,s=t.light,o=function(t){console.log("Apply state "+JSON.stringify(t)),r.a.put("/api/".concat(e,"/lights/").concat(c,"/state"),t)},j=Object(a.useState)(s.state),h=Object(n.a)(j,2),b=h[0];h[1];return Object(d.jsxs)("div",{className:"lightContainer ".concat(b.on?"textDark":"textLight"),style:{background:"xy"===b.colormode?l(b.xy[0],b.xy[1],254):"ct"===b.colormode?u(b.ct):"linear-gradient(90deg, rgba(255,212,93,1))"},children:[Object(d.jsx)("div",{className:"iconContainer",children:Object(d.jsx)(i.i,{})}),Object(d.jsx)("div",{className:"textContainer",children:Object(d.jsx)("p",{children:s.name})}),Object(d.jsx)("div",{className:"switchContainer",children:Object(d.jsxs)("label",{className:"switch",children:[Object(d.jsx)("input",{type:"checkbox",defaultChecked:b.on,onChange:function(t){return o({on:t.currentTarget.checked})}}),Object(d.jsx)("span",{className:"slider"})]})}),Object(d.jsx)("div",{className:"slideContainer",children:Object(d.jsx)("input",{type:"range",min:"1",max:"254",defaultValue:"50",className:"slider",onChange:function(t){return o({bri:t.currentTarget.value})}})})]})},g=c(83);function f(t){var e=t.user,c=t.lights,s=t.groupLights,i=Object(a.useRef)(null),u=Object(a.useRef)(null),h=Object(a.useState)(!0),b=Object(n.a)(h,2),f=b[0],p=b[1];Object(a.useEffect)((function(){return p(!1),function(){p(!1)}}),[]);var O,x=[],v=Object(o.a)(s.entries());try{for(v.s();!(O=v.n()).done;){var m=Object(n.a)(O.value,2),y=(m[0],m[1]);"xy"in c[y].state&&x.push(l(c[y].state.xy[0],c[y].state.xy[1],254))}}catch(k){v.e(k)}finally{v.f()}var N=function(t){var c=t.rgb;console.log(t.rgb),console.log("Apply state "+JSON.stringify(t)),r.a.put("/api/".concat(e,"/lights/").concat(s[t.index],"/state"),{xy:j(c.r,c.g,c.b)})};return Object(a.useEffect)((function(){i.current&&!u.current&&(u.current=new g.a.ColorPicker(i.current,{layout:[{component:g.a.ui.Wheel,options:{}}],colors:x}),u.current.on("input:end",N))}),[i.current]),Object(d.jsx)("div",{ref:i,className:f?"hide":"show"})}var p=function(t){var e=t.api_key,c=t.id,s=t.group,j=t.lights,g=t.scenes,p=Object(a.useState)("closed"),O=Object(n.a)(p,2),x=O[0],v=O[1],m=Object(a.useState)(s.state.any_on),y=Object(n.a)(m,2),N=y[0],k=y[1],C=Object(a.useState)(s.action.bri),M=Object(n.a)(C,2),w=M[0],S=M[1];return Object(d.jsxs)("div",{className:"groupContainer ".concat(s.state.any_on?"textDark":"textLight"," ").concat("closed"!==x?"expanded":""),style:function(){if(s.state.any_on){var t,e="linear-gradient(90deg, ",c=100/s.lights.length,a=Object(o.a)(s.lights.entries());try{for(a.s();!(t=a.n()).done;){var r=Object(n.a)(t.value,2),i=r[0],d=r[1];e="xy"===j[d].state.colormode?e+l(j[d].state.xy[0],j[d].state.xy[1],254)+" "+Math.floor(c*(i+1))+"%,":"ct"===j[d].state.colormode?e+u(j[d].state.ct)+" "+Math.floor(c*(i+1))+"%,":e+"rgba(255,212,93,1) "+Math.floor(c*(i+1))+"%,"}}catch(h){a.e(h)}finally{a.f()}return{background:e.slice(0,-1)+")"}}}(),children:["closed"!==x&&Object(d.jsxs)("div",{className:"header",children:[Object(d.jsxs)("div",{onClick:function(){return v("closed")},children:[Object(d.jsx)("div",{className:"icon",children:Object(d.jsx)(i.c,{})}),Object(d.jsx)("div",{className:"text",children:"close"})]}),Object(d.jsx)("div",{className:"tab ".concat("lights"===x?"active":""),onClick:function(){return v("lights")},children:Object(d.jsx)(i.k,{})}),Object(d.jsx)("div",{className:"tab ".concat("scenes"===x?"active":""),onClick:function(){return v("scenes")},children:Object(d.jsx)(i.l,{})}),Object(d.jsx)("div",{className:"tab ".concat("colorPicker"===x?"active":""),onClick:function(){return v("colorPicker")},children:Object(d.jsx)(i.n,{})})]}),Object(d.jsx)("div",{className:"overlayBtn",onClick:function(){return v("colorPicker")}}),Object(d.jsx)("div",{className:"iconContainer",children:Object(d.jsx)(i.e,{})}),Object(d.jsx)("div",{className:"textContainer",children:Object(d.jsx)("p",{children:s.name})}),Object(d.jsx)("div",{className:"switchContainer",children:Object(d.jsxs)("label",{className:"switch",children:[Object(d.jsx)("input",{type:"checkbox",value:N,onChange:function(t){return function(t){var n={on:t};k(t),console.log("Apply state "+JSON.stringify(n)),r.a.put("http://localhost/api/".concat(e,"/groups/").concat(c,"/action"),n)}(t.target.checked)}}),Object(d.jsx)("span",{className:"slider"})]})}),Object(d.jsx)("div",{className:"slideContainer",children:Object(d.jsx)("input",{type:"range",min:"1",max:"254",value:w,step:"1",className:"slider",onChange:function(t){return function(t){var n={bri:t};S(t),console.log("Apply state "+JSON.stringify(n)),r.a.put("http://localhost/api/".concat(e,"/groups/").concat(c,"/action"),n)}(t.target.value)}})}),Object(d.jsxs)("div",{className:"dimmer",children:["scenes"===x&&Object(d.jsx)(h,{api_key:e,groupId:c,scenes:g}),"lights"===x&&Object(d.jsx)("div",{className:"lightsContainer",children:s.lights.map((function(t){return Object(d.jsx)(b,{api_key:e,id:t,light:j[t]},t)}))}),"colorPicker"===x&&Object(d.jsx)(f,{api_key:e,lights:j,groupLights:s.lights})]})]})};function O(){var t=Object(a.useState)({config:{},lights:{},groups:{},scenes:{}}),e=Object(n.a)(t,2),c=e[0],s=e[1],o=Object(a.useState)(),i=Object(n.a)(o,2),l=i[0],u=i[1];Object(a.useEffect)((function(){r.a.get("http://localhost/get-key").then((function(t){"string"===typeof t.data&&32===t.data.length?(console.log("API_KEY from API: ".concat(t.data)),u(t.data)):u("12345678901234567890123456789012"),j()})).catch((function(t){console.error(t)}))}),[]);var j=function(){r.a.get("http://localhost/api/".concat(l)).then((function(t){console.log(t.data),s(t.data)})).catch((function(t){console.error(t)}))};return Object(a.useEffect)((function(){var t=setInterval((function(){void 0!==l?j():console.log("No Key")}),1e4);return function(){return clearInterval(t)}}),[l]),Object(d.jsx)("div",{className:"content",children:Object(d.jsx)("div",{className:"cardGrid",children:Object.entries(c.groups).filter((function(t){return"Entertainment"!==t[1].type})).map((function(t){var e=Object(n.a)(t,2),a=e[0],s=e[1];return Object(d.jsx)(p,{api_key:l,id:a,group:s,lights:c.lights,scenes:c.scenes},a)}))})})}}}]);
//# sourceMappingURL=4.f99e2ce2.chunk.js.map
{"version":3,"sources":["containers/Light.js","views/Lights.js","containers/Flash.js","color.js"],"names":["Light","api_key","id","light","modelIds","setType","setMessage","className","onClick","axios","put","then","fetchedData","console","log","data","catch","error","title","options","value","onChange","e","modelid","post","placeholder","delete","Groups","API_KEY","useState","lights","setLights","setModelIds","type","message","fetchConfig","undefined","get","useEffect","interval","setInterval","clearInterval","Flash","duration","Object","entries","map","persistOnHover","cieToRgb","x","y","brightness","z","Y","toFixed","X","Z","red","green","blue","Math","pow","round","isNaN","floor","colorTemperatureToRgb","mireds","hectemp","rgbToCie","parseFloat"],"mappings":"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","file":"static/js/5.917e7421.chunk.js","sourcesContent":["import { FaLightbulb, FaCheck } from \"react-icons/fa\";\nimport { MdDeleteForever, MdSystemUpdate } from \"react-icons/md\";\nimport { RiAlertLine } from \"react-icons/ri\";\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport {cieToRgb, colorTemperatureToRgb } from \"../color\";\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\n\n\nconst Light = ({api_key, id, light, modelIds, setType, setMessage}) => {\n\n  const deleteLight = () => {\n    axios.delete(`/api/${api_key}/lights/${id}`)\n    .then((fetchedData) => {\n      console.log(fetchedData.data);\n      setMessage('Light successfully deleted');\n      setType('none');\n      setType('success');\n    }).catch((error) => {\n      console.error(error)\n      setMessage('Error occured, check browser console');\n      setType('none');\n      setType('error');\n    });\n  }\n\n  const alertLight = () => {\n    axios.put(`/api/${api_key}/lights/${id}/state`, {\"alert\": \"select\"})\n    .then((fetchedData) => {\n      console.log(fetchedData.data);\n      setMessage('Light alerted');\n      setType('none');\n      setType('success');\n    }).catch((error) => {\n      console.error(error)\n      setMessage('Error occured, check browser console');\n      setType('none');\n      setType('error');\n    });\n  }\n\n  const setModelId = (modelid) => {\n    console.log( {[id]: modelid})\n    axios.post(`/light-types`, {[id]: modelid})\n    .then((fetchedData) => {\n      console.log(fetchedData.data);\n      setMessage('Modelid updated');\n      setType('none');\n      setType('success');\n    }).catch((error) => {\n      console.error(error)\n      setMessage('Error occured, check browser console');\n      setType('none');\n      setType('error');\n    });\n  }\n\n  return (\n    <>\n    <div className=\"iconContainer\">\n      <FaLightbulb onClick={() => alertLight()}/>\n    </div>\n    {light[\"name\"]} {light['state']['reachable'] && <FaCheck title='Reachable'/> || <RiAlertLine title='Unrechable'/>}<br/>\n    <Dropdown options={modelIds} value={light[\"modelid\"]} onChange={(e) => setModelId(e.value)} placeholder=\"Choose light modelid\" />\n     Protocol: {light[\"protocol\"]}<br/> IP: {light[\"protocol_cfg\"][\"ip\"]}<br/>\n    <MdDeleteForever title='Delete' onClick={() => deleteLight()}/>  <MdSystemUpdate title='Update' />\n    </>\n  )\n}\n\nexport default Light\n","import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Light from \"../containers/Light\";\nimport Flash from \"../containers/Flash\"\n\nexport default function Groups({API_KEY}) {\n\n  const [lights, setLights] = useState({});\n  const [modelIds, setModelIds] = useState([]);\n  const [type, setType] = useState('none');\n  const [message, setMessage] = useState('no message');\n\n  const fetchConfig = () => {\n    if (API_KEY !== undefined ) {\n      axios\n      .get(`/lights`)\n      .then((fetchedData) => {\n        console.log(fetchedData.data);\n        setLights(fetchedData.data);\n      }).catch((error) => {console.error(error)});\n    }\n  }\n\n  const fetchModelIds = () => {\n    if (API_KEY !== undefined ) {\n      axios\n      .get(`/light-types`)\n      .then((fetchedData) => {\n        console.log(fetchedData.data);\n        setModelIds(fetchedData.data['result']);\n      }).catch((error) => {console.error(error)});\n    }\n  }\n\n\n  useEffect(() => {\n    fetchConfig();\n    fetchModelIds();\n    const interval = setInterval(() => {\n      fetchConfig();\n    }, 2000); // <<-- ⏱ 1000ms = 1s\n    return () => clearInterval(interval);\n  }, [API_KEY]);\n\n  return (\n    <div className=\"content\">\n      {type !== 'none' && <Flash type={type} message={message} duration=\"5000\" setType={setType} />}\n      <div className=\"cardGrid\">\n        {Object.entries(lights).map(([id, light]) => (\n            <Light\n              key={id}\n              api_key={API_KEY}\n              id={id}\n              light={light}\n              modelIds={modelIds}\n              setType={setType}\n              setMessage={setMessage}\n            />\n        ))}\n        </div>\n      </div>\n    );\n  }\n","import { useState } from \"react\";\nimport { FaTimes } from \"react-icons/fa\";\nimport FlashMessage from 'react-flash-message'\n\nexport default function Flash({type, message, duration, setType}) {\n\n    return (\n        <FlashMessage duration={duration} persistOnHover={true}>\n        <div className=\"notificationContainer\">\n            <div className={`notification success`}><p>{message}</p><div className=\"icon\"><FaTimes onClick={() => setType('none')}/></div></div>\n        </div>\n        </FlashMessage>\n    );\n    }\n","export function cieToRgb(x, y, brightness) {\n  //Set to maximum brightness if no custom value was given (Not the slick ECMAScript 6 way for compatibility reasons)\n  if (brightness === undefined) {\n    brightness = 254;\n  }\n\n  var z = 1.0 - x - y;\n  var Y = (brightness / 254).toFixed(2);\n  var X = Y / y * x;\n  var Z = Y / y * z;\n\n  //Convert to RGB using Wide RGB D65 conversion\n  var red = X * 1.656492 - Y * 0.354851 - Z * 0.255038;\n  var green = -X * 0.707196 + Y * 1.655397 + Z * 0.036152;\n  var blue = X * 0.051713 - Y * 0.121364 + Z * 1.01153;\n\n  //If red, green or blue is larger than 1.0 set it back to the maximum of 1.0\n  if (red > blue && red > green && red > 1.0) {\n    green = green / red;\n    blue = blue / red;\n    red = 1.0;\n  } else if (green > blue && green > red && green > 1.0) {\n    red = red / green;\n    blue = blue / green;\n    green = 1.0;\n  } else if (blue > red && blue > green && blue > 1.0) {\n    red = red / blue;\n    green = green / blue;\n    blue = 1.0;\n  }\n\n  //Reverse gamma correction\n  red =\n    red <= 0.0031308\n      ? 12.92 * red\n      : (1.0 + 0.055) * Math.pow(red, 1.0 / 2.4) - 0.055;\n  green =\n    green <= 0.0031308\n      ? 12.92 * green\n      : (1.0 + 0.055) * Math.pow(green, 1.0 / 2.4) - 0.055;\n  blue =\n    blue <= 0.0031308\n      ? 12.92 * blue\n      : (1.0 + 0.055) * Math.pow(blue, 1.0 / 2.4) - 0.055;\n\n  //Convert normalized decimal to decimal\n  red = Math.round(red * 255);\n  green = Math.round(green * 255);\n  blue = Math.round(blue * 255);\n\n  if (isNaN(red)) red = 0;\n\n  if (isNaN(green)) green = 0;\n\n  if (isNaN(blue)) blue = 0;\n\n  return \"rgba(\" + Math.floor(red) + \",\" +  Math.floor(green) + \",\" + Math.floor(blue) + \",1)\";\n}\n\nexport function colorTemperatureToRgb(mireds) {\n  var hectemp = 20000.0 / mireds;\n\n  var red, green, blue;\n\n  if (hectemp <= 66) {\n    red = 255;\n    green = 99.4708025861 * Math.log(hectemp) - 161.1195681661;\n    blue =\n      hectemp <= 19\n        ? 0\n        : 138.5177312231 * Math.log(hectemp - 10) - 305.0447927307;\n  } else {\n    red = 329.698727446 * Math.pow(hectemp - 60, -0.1332047592);\n    green = 288.1221695283 * Math.pow(hectemp - 60, -0.0755148492);\n    blue = 255;\n  }\n\n  red = red > 255 ? 255 : red;\n  green = green > 255 ? 255 : green;\n  blue = blue > 255 ? 255 : blue;\n\n  return \"rgba(\" + Math.floor(red) + \",\" +  Math.floor(green) + \",\" + Math.floor(blue) + \",1)\";\n}\n\nexport function rgbToCie(red, green, blue) {\n  //Apply a gamma correction to the RGB values, which makes the color more vivid and more the like the color displayed on the screen of your device\n  red =\n    red > 0.04045 ? Math.pow((red + 0.055) / (1.0 + 0.055), 2.4) : red / 12.92;\n  green =\n    green > 0.04045\n      ? Math.pow((green + 0.055) / (1.0 + 0.055), 2.4)\n      : green / 12.92;\n  blue =\n    blue > 0.04045\n      ? Math.pow((blue + 0.055) / (1.0 + 0.055), 2.4)\n      : blue / 12.92;\n\n  //RGB values to XYZ using the Wide RGB D65 conversion formula\n  var X = red * 0.664511 + green * 0.154324 + blue * 0.162028;\n  var Y = red * 0.283881 + green * 0.668433 + blue * 0.047685;\n  var Z = red * 0.000088 + green * 0.07231 + blue * 0.986039;\n\n  //Calculate the xy values from the XYZ values\n  var x = (X / (X + Y + Z)).toFixed(4);\n  var y = (Y / (X + Y + Z)).toFixed(4);\n\n  if (isNaN(x)) x = 0;\n\n  if (isNaN(y)) y = 0;\n\n  return [parseFloat(x), parseFloat(y)];\n}\n"],"sourceRoot":""}